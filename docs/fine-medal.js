var fineMedal;(()=>{"use strict";var e={d:(r,t)=>{for(var n in t)e.o(t,n)&&!e.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:t[n]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};e.r(r),e.d(r,{getPreviews:()=>G,init:()=>z});var t="undefined"!=typeof Float32Array?Float32Array:Array;function n(){var e=new t(16);return t!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});var o=function(e,r,t,n,o){var a,i=1/Math.tan(r/2);return e[0]=i/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=o&&o!==1/0?(a=1/(n-o),e[10]=(o+n)*a,e[14]=2*o*n*a):(e[10]=-1,e[14]=-2*n),e};function a(e,r){var t=r[0],n=r[1],o=r[2],a=r[3],i=r[4],c=r[5],s=r[6],u=r[7],l=r[8],f=r[9],m=r[10],d=r[11],v=r[12],h=r[13],g=r[14],p=r[15],x=t*c-n*i,M=t*s-o*i,_=t*u-a*i,y=n*s-o*c,w=n*u-a*c,E=o*u-a*s,T=l*h-f*v,A=l*g-m*v,P=l*p-d*v,b=f*g-m*h,R=f*p-d*h,L=m*p-d*g,C=x*L-M*R+_*b+y*P-w*A+E*T;return C?(C=1/C,e[0]=(c*L-s*R+u*b)*C,e[1]=(s*P-i*L-u*A)*C,e[2]=(i*R-c*P+u*T)*C,e[3]=(o*R-n*L-a*b)*C,e[4]=(t*L-o*P+a*A)*C,e[5]=(n*P-t*R-a*T)*C,e[6]=(h*E-g*w+p*y)*C,e[7]=(g*_-v*E-p*M)*C,e[8]=(v*w-h*_+p*x)*C,e):null}function i(e,r,t){const n=e.createShader(r);return e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(alert("An error occurred compiling the shaders: "+e.getShaderInfoLog(n)),e.deleteShader(n),null)}function c(e,r,t){const n=i(e,e.VERTEX_SHADER,r),o=i(e,e.FRAGMENT_SHADER,t),a=e.createProgram();return e.attachShader(a,n),e.attachShader(a,o),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)?a:(alert("Unable to initialize the shader program: "+e.getProgramInfoLog(a)),null)}function s(e,r,t,n,o=""){t=t.split(" "),n=n.split(" "),o=o.split(" ");const a={program:r,attribLocations:{},uniformLocations:{},uniformLocations_ext:{}};return t.forEach((t=>a.attribLocations[t]=e.getAttribLocation(r,t))),n.forEach((t=>a.uniformLocations[t]=e.getUniformLocation(r,t))),o.forEach((t=>a.uniformLocations_ext[t]=e.getUniformLocation(r,t))),a}function u(e,r){r.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,r.vertex,e.STATIC_DRAW),r.normalBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.normalBuffer),e.bufferData(e.ARRAY_BUFFER,r.normal,e.STATIC_DRAW),r.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r.indices,e.STATIC_DRAW)}function l(e){const r=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/r,e[1]/r,e[2]/r]}function f(e,r,t=0){const n=[];for(let o=0;o<e;o++){const a=2*Math.PI*o/e,i=r*Math.cos(a),c=r*Math.sin(a);n.push([i,c,t])}return n}const m={seg_cirle:64,seg_edge:32,radius:1,edge_count:Math.floor(128/3),radius_inner:.93,radius_edge:1-.93};const d="varying highp vec3 vColor;\nvarying highp vec3 vTransformedNormal;\nvarying highp vec3 vPosition;\nvoid main(void) {\n    highp vec3 specularColor = vec3(1.0, 1.0, 1.0);\n    highp float shininess = 32.0;\n          \n    //gl_FragColor = texture2D(uSampler, vTextureCoord)\n    highp vec3 lightDir = normalize(vPosition - vec3(3, 0, 4));\n    highp vec3 viewDir = normalize(vec3(0.0, -0.0, -1));\n    highp vec3 reflectDir = reflect(-lightDir, vTransformedNormal);\n    highp float specular = pow(max(dot(viewDir, reflectDir), 0.0), shininess);\n    specularColor = specular * specularColor;\n\n    gl_FragColor = vec4(vColor + specularColor, 1.0);\n    //gl_FragColor = vec4(vColor, 1.0); //for debug\n   \n}",v="attribute vec3 aVertexPosition;\nattribute vec3 aVertexNormal;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform highp vec3 uBaseColor;\nvarying highp vec3 vColor;\nvarying highp vec3 vTransformedNormal;\nvarying highp vec3 vPosition;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(aVertexPosition, 1.0);\n    vPosition = (uModelViewMatrix * vec4(aVertexPosition, 1.0)).xyz;\n    vTransformedNormal = normalize(uNormalMatrix * aVertexNormal);\n    highp vec3 viewDir = vec3(0, 0, -1);\n    highp float amb = max(-dot(vTransformedNormal, viewDir), 0.0);\n    vColor = uBaseColor * (0.5 + 0.5 * amb);\n}",h="varying highp vec2 vTextureCoord;\nvarying highp vec3 vTransformedNormal;\nvarying highp vec3 vPosition;\nuniform sampler2D uSampler;\n\nvoid main(void) {\n    highp vec4 baseColor = texture2D(uSampler, vTextureCoord);\n\n    highp vec3 specularColor = vec3(1.0, 1.0, 1.0);\n    highp float shininess = 32.0;\n          \n    highp vec3 lightDir = normalize(vPosition - vec3(3, 0, 4));\n    highp vec3 viewDir = normalize(vec3(0.0, -0.0, -1));\n    highp vec3 reflectDir = reflect(-lightDir, vTransformedNormal);\n    highp float specular = pow(max(dot(viewDir, reflectDir), 0.0), shininess);\n    specularColor = specular * specularColor;\n    gl_FragColor = baseColor + vec4(specularColor, 1.0);\n\n}\n",g="attribute vec3 aVertexPosition;\nattribute vec3 aVertexNormal;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform highp float uInverseRadius;\nvarying highp vec3 vTransformedNormal;\nvarying highp vec2 vTextureCoord;\nvarying highp vec3 vPosition;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(aVertexPosition, 1.0);\n    vPosition = (uModelViewMatrix * vec4(aVertexPosition, 1.0)).xyz;\n    vTransformedNormal = normalize(uNormalMatrix * aVertexNormal);\n    float x = aVertexPosition.x * uInverseRadius;\n    float y = aVertexPosition.y * uInverseRadius;\n    vTextureCoord = vec2(\n        x * 0.5 + 0.5,\n        -y * 0.5 + 0.5\n    );\n}";function p(e,r){const t=e.getBoundingClientRect();return{x:r.clientX-t.left,y:r.clientY-t.top,w:t.width,h:t.height}}let x=null;function M(e,r,t,n,o){if(x)return;x=e,e.className="hide";const a=e.getBoundingClientRect(),i=window.innerWidth,c=(window.innerHeight,a.left+a.width/2);a.top,a.height,r.className="show_trans";const s=`\n    ${t}.show_trans {\n        opacity: 0;\n        transform: translate(-50%, 0) scale(0);\n        top: 40px;\n        left: ${c}px;\n     }\n  \n    ${t}.show {\n        opacity: 1;\n        transform: translate(-50%, 0) scale(1);\n        top: 10px;\n        left: ${i/2}px;\n    }`;n.innerHTML=s,requestAnimationFrame((()=>{r.className="show",o()}))}const _=[-0,0,-2.7],y=n(),w=.1,E=100,T=2*Math.PI,A=5*Math.PI/180,P=.9,b=1e-4,R=2e-5;let L=0,C=0;function F(e,r){const{x:t,y:n,w:o,h:a}=e;let i=t-o/2,c=n-a/2;if(i*i+c*c>o*o/4*.9)return;let s=i*Math.min(r,800)*.001*.001;C+=s}let B,N,I,S,D,V,U,q=!1;function Y(e,r,o=!0,i=0){q=o;let c=0;L=0,C=0,requestAnimationFrame((function o(s){const u=s-c;switch(c=s,i){case 0:break;case 1:L+=9e-4*u;break;case 2:!function(e){L+=e*C,L>T&&(L-=T),L<0&&(L+=T),L<Math.PI?L<A?(C*=P,C+=(Math.random()-.5)*b):C-=R*(L-A)*e:T-L<A?(C*=P,C+=(Math.random()-.5)*b):C+=R*(T-L-A)*e}(u)}const l=n();var f,m,d,v,h,g,p,x,M,w,E,F,B,N,I,S,D,V;f=l,m=l,S=(d=_)[0],D=d[1],V=d[2],m===f?(f[12]=m[0]*S+m[4]*D+m[8]*V+m[12],f[13]=m[1]*S+m[5]*D+m[9]*V+m[13],f[14]=m[2]*S+m[6]*D+m[10]*V+m[14],f[15]=m[3]*S+m[7]*D+m[11]*V+m[15]):(v=m[0],h=m[1],g=m[2],p=m[3],x=m[4],M=m[5],w=m[6],E=m[7],F=m[8],B=m[9],N=m[10],I=m[11],f[0]=v,f[1]=h,f[2]=g,f[3]=p,f[4]=x,f[5]=M,f[6]=w,f[7]=E,f[8]=F,f[9]=B,f[10]=N,f[11]=I,f[12]=v*S+x*D+F*V+m[12],f[13]=h*S+M*D+B*V+m[13],f[14]=g*S+w*D+N*V+m[14],f[15]=p*S+E*D+I*V+m[15]),function(e,r,t){var n=Math.sin(t),o=Math.cos(t),a=r[0],i=r[1],c=r[2],s=r[3],u=r[8],l=r[9],f=r[10],m=r[11];r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=a*o-u*n,e[1]=i*o-l*n,e[2]=c*o-f*n,e[3]=s*o-m*n,e[8]=a*n+u*o,e[9]=i*n+l*o,e[10]=c*n+f*o,e[11]=s*n+m*o}(l,l,L),r.view=l,function(e,r,n,o){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);for(const o of n)for(const n of o.parts){e.useProgram(n.programInfo.program),e.bindBuffer(e.ARRAY_BUFFER,n.geomertry.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.geomertry.indexBuffer),e.enableVertexAttribArray(n.programInfo.attribLocations.aVertexPosition),e.vertexAttribPointer(n.programInfo.attribLocations.aVertexPosition,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,n.geomertry.normalBuffer),e.enableVertexAttribArray(n.programInfo.attribLocations.aVertexNormal),e.vertexAttribPointer(n.programInfo.attribLocations.aVertexNormal,3,e.FLOAT,!1,0,0),e.uniformMatrix4fv(n.programInfo.uniformLocations.uProjectionMatrix,!1,r),e.uniformMatrix4fv(n.programInfo.uniformLocations.uModelViewMatrix,!1,o.view);const c=(i=void 0,i=new t(9),t!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i);a(c,o.view),e.uniformMatrix3fv(n.programInfo.uniformLocations.uNormalMatrix,!1,c);for(const r in n.programInfo.uniformLocations_ext){const t=n.programInfo.uniformLocations_ext[r],o=n[r];e[o.func](t,o.v)}void 0!==n.programInfo.uniformLocations.uSampler&&(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n.texture),e.uniform1i(n.programInfo.uniformLocations.uSampler,0));const s=n.geomertry.indices.length,u=0;e.drawElements(e.TRIANGLES,s,e.UNSIGNED_SHORT,u)}var i}(e,y,[r]),q&&requestAnimationFrame(o)}))}const j={},O={};let H;async function z(e){if(U=e,B=document.querySelector(U.dialog_selector),N=document.querySelector(U.canvas_selector),I=document.querySelector(U.style_selector),S=document.querySelector(U.name_selector),D=document.querySelector(U.desc_selector),V=function(e){const r=e.getContext("webgl2");return r?(r.clearColor(0,0,0,0),r.clearDepth(1),r.enable(r.DEPTH_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),r.depthFunc(r.LEQUAL),r):(alert("Unable to initialize WebGL. Your browser may not support it."),null)}(N),!V)return;const r=c(V,v,d),t=s(V,r,"aVertexPosition aVertexNormal","uModelViewMatrix uProjectionMatrix uNormalMatrix","uBaseColor"),a=c(V,g,h),i=s(V,a,"aVertexPosition aVertexNormal","uSampler uModelViewMatrix uProjectionMatrix uNormalMatrix","uInverseRadius"),M=function(){const{seg_cirle:e,seg_edge:r,radius:t,edge_count:n,radius_inner:o,radius_edge:a}=m,i=[];for(let t=0;t<=n;t++){const n=Math.PI*t/r,c=-a*Math.cos(n),s=a*Math.sin(n);i.push(f(e,o+s,c))}const c=i.length*e+1,s=new Float32Array(3*c),u=new Float32Array(3*c);let d=0;i.forEach((e=>{e.forEach((e=>{s.set(e,d);const r=function(e,r){const t=e[0],n=e[1],o=e[2],a=l([t,n,0]).map((e=>e*r));return l([t-a[0],n-a[1],o-a[2]])}(e,o);u.set(r,d),d+=3}))})),s.set([0,0,-a],d),u.set([0,0,-1],d);const v=[];for(let r=0;r<i.length-1;r++){const t=r*e;for(let r=0;r<e;r++)v.push(t+r,t+(r+1)%e,t+r+e),v.push(t+(r+1)%e,t+(r+1)%e+e,t+r+e)}const h=c-1;for(let r=0;r<e;r++)v.push((r+1)%e,r,h);return{vertex:s,normal:u,indices:new Uint16Array(v)}}(),_=function(){const{seg_cirle:e,seg_edge:r,radius:t,edge_count:n,radius_inner:o,radius_edge:a}=m,i=Math.PI*n/r,c=-a*Math.cos(i),s=f(e,o+a*Math.sin(i),c),u=e+1,l=new Float32Array(3*u),d=new Float32Array(3*u);let v=0,h=[0,0,1];s.forEach((e=>{l.set(e,v),d.set(h,v),v+=3})),l.set([0,0,c],v),d.set(h,v);const g=[],p=u-1;for(let r=0;r<e;r++)g.push(r,(r+1)%e,p);return{vertex:l,normal:d,indices:new Uint16Array(g)}}();u(V,M),u(V,_),H=async function(e){let r,o;return e.texture&&(r=await async function(e){const r=j[e];if(r)return r;const t=await async function(e){return new Promise(((r,t)=>{let n=new Image;n.onload=()=>r(n),n.onerror=t,n.src=e}))}(e+U.textureExt),n=V.createTexture();V.bindTexture(V.TEXTURE_2D,n);const o=V.RGB,a=V.RGB,i=V.UNSIGNED_BYTE;return V.texImage2D(V.TEXTURE_2D,0,o,a,i,t),V.generateMipmap(V.TEXTURE_2D),V.pixelStorei(V.UNPACK_FLIP_Y_WEBGL,!0),j[e]=n,n}(e.texture)),"basic"===e.type&&(o=function(e,r){return{view:n(),parts:[{programInfo:t,geomertry:M,uBaseColor:{func:"uniform3fv",v:r}},{programInfo:i,geomertry:_,texture:e,uInverseRadius:{func:"uniform1f",v:1/_.vertex[0]}}]}}(r,e.baseColor)),o.name=e.name,o.desc=e.desc,o},function(e,r){!function(e,r){let t=0,n=null,o=!1,a=!1;function i(){const e=performance.now();a&&(r(n,e-t),a=!1)}e.addEventListener("mousedown",(function(e){o||(t=performance.now(),a=!0)})),e.addEventListener("touchstart",(function(r){o=!0,n=p(e,r.touches[0]),t=performance.now(),a=!0})),e.addEventListener("mouseup",(function(r){o||(n=p(e,r),i())})),e.addEventListener("touchend",(function(e){i(),o=!1})),e.addEventListener("mouseout",(function(e){a=!1})),e.addEventListener("touchcancel",(function(e){a=!1,o=!1})),e.addEventListener("focusout",(function(e){a=!1,o=!1}))}(e,F);const t=45*Math.PI/180,n=r.canvas.clientWidth/r.canvas.clientHeight;o(y,t,n,w,E)}(N,V),B.className="idle",B.querySelector("button").onclick=()=>function(e){e.className="show_trans",x.className="",x=null,q=!1,setTimeout((()=>{e.className="idle"}),500)}(B)}async function G(e,r){B.className="init",await X();const t=document.querySelector(e);t.innerHTML="";for(const e of r){let r=O[e];r||(O[e]=await H(U.medals[e]),r=O[e]);let n=r.preview;n||(Y(V,r,!1,0),await X(),r.preview=await W(N),n=r.preview);const o=document.createElement("div");o.setAttribute("data-id",e),o.title=r.name;let a=new Image;a.src=n,o.appendChild(a),o.addEventListener("click",(()=>{M(o,B,U.dialog_selector,I,(()=>{Y(V,r,!0,2),S.innerHTML=r.name,D.innerHTML=r.desc}))})),t.appendChild(o)}B.className="idle"}async function W(e){return new Promise(((r,t)=>{e.toBlob((e=>{if(e){const t=URL.createObjectURL(e);r(t)}else t(new Error("Canvas toBlob failed."))}))}))}async function X(){return new Promise((e=>{requestAnimationFrame(e)}))}fineMedal=r})();